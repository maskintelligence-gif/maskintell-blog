---
import BaseLayout from "../../layouts/BaseLayout.astro";
import posts from "../../../content/posts";

/* =========================
   STATIC PATHS
========================= */
export async function getStaticPaths() {
  return posts
    .filter((post) => post.status === "published")
    .map((post) => ({
      params: { slug: post.slug },
      props: { post },
    }));
}

/* =========================
   CURRENT POST
========================= */
const { post } = Astro.props;

/* =========================
   SEO
========================= */
const metaTitle =
  post.seo_meta_title || post.title;

const metaDescription =
  post.seo_meta_description || post.excerpt;

const canonical =
  post.canonical || `/blog/${post.slug}`;
---

<BaseLayout>

  <article class="post container">
    <header class="post-header">
      <h1>{post.title}</h1>

      <div class="post-meta">
        <span>
          {new Date(post.date).toLocaleDateString()}
        </span>

        {post.reading_time > 0 && (
          <span>· {post.reading_time} min read</span>
        )}

        <span>· By {post.author}</span>
      </div>

      {post.thumbnail && (
        <img
          src={post.thumbnail}
          alt={post.image_alt || post.title}
          class="post-image"
        />
      )}
    </header>

    <section class="post-body">
      <AstroMarkdown content={post.body} />

   <script type="application/ld+json">
{JSON.stringify({
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": post.title,
  "description": post.excerpt,
  "datePublished": post.date,
  "author": {
    "@type": "Organization",
    "name": "MASK Intelligence"
  }
})}
</script>

    </section>

  </article>

</BaseLayout>
