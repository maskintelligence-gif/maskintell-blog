---
import BaseLayout from "../../layouts/BaseLayout.astro";
import FAQItem from "../../components/FAQItem.astro";
import FAQSearch from "../../components/FAQSearch.astro";

const faqs = await Astro.glob("../../content/faqs/*.md");

const ordered = faqs
  .map(f => f.frontmatter)
  .sort((a, b) => a.order - b.order);

// Group by category
const categories = {};
for (const faq of ordered) {
  const cat = faq.category || "General";
  if (!categories[cat]) categories[cat] = [];
  categories[cat].push(faq);
}
---

<BaseLayout
  title="Frequently Asked Questions"
  description="Answers to common questions about MASK Intelligence."
>
  <section
    class="container"
    itemscope
    itemtype="https://schema.org/FAQPage"
  >
    <h1>FAQs</h1>

    <FAQSearch />

    {Object.entries(categories).map(([category, items]) => (
      <section class="faq-category">
        <h2>{category}</h2>

        {items.map(faq => (
          <FAQItem faq={faq} />
        ))}
      </section>
    ))}
  </section>
</BaseLayout>
