---
import BaseLayout from "../../layouts/BaseLayout.astro";
import projects from "../../../content/portfolio";

/* =========================
   STATIC PATHS
========================= */
export async function getStaticPaths() {
  return projects
    .filter((project) => project.status === "published")
    .map((project) => ({
      params: { slug: project.slug },
      props: { project },
    }));
}

const { project } = Astro.props;

/* =========================
   SEO
========================= */
const metaTitle =
  project.seo_meta_title || project.title;

const metaDescription =
  project.seo_meta_description || project.short_description;

const canonical =
  project.canonical || `/portfolio/${project.slug}`;
---

<BaseLayout>

  <article class="portfolio container">
    <header class="portfolio-header">
      <h1>{project.title}</h1>

      <div class="portfolio-meta">
        <span>{project.category}</span>
        <span>· {project.year}</span>
        <span>· {project.client}</span>
      </div>

      {project.hero_image && (
        <img
          src={project.hero_image}
          alt={project.image_alt || project.title}
          class="portfolio-hero"
        />
      )}
    </header>

    <section class="portfolio-body">
      <AstroMarkdown content={project.body} />
    </section>

    {project.technologies?.length > 0 && (
      <section class="portfolio-tech">
        <h2>Technologies</h2>
        <ul>
          {project.technologies.map((tech) => (
            <li>{tech}</li>
          ))}
        </ul>
      </section>
    )}

    {project.results?.length > 0 && (
      <section class="portfolio-results">
        <h2>Results</h2>
        <ul>
          {project.results.map((result) => (
            <li>{result}</li>
          ))}
        </ul>
      </section>
    )}

    {project.links && (
      <section class="portfolio-links">
        {project.links.demo && (
          <a href={project.links.demo} class="button">
            Live Demo
          </a>
        )}
        {project.links.github && (
          <a href={project.links.github} class="button secondary">
            Source Code
          </a>
        )}
      </section>
    )}

  </article>

</BaseLayout>
