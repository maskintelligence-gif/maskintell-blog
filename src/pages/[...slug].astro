---
import BaseLayout from "../layouts/BaseLayout.astro";
import pages from "../../content/pages";

/* =========================
   STATIC ROUTES FROM CMS
========================= */
export async function getStaticPaths() {
  return pages
    .filter((page) => page.published !== false)
    .map((page) => {
      const clean = page.permalink
        .replace(/^\/|\/$/g, "")
        .split("/");

      return {
        params: {
          slug: clean.length ? clean : undefined,
        },
        props: {
          page,
        },
      };
    });
}

/* =========================
   CURRENT PAGE
========================= */
const { page } = Astro.props;

/* =========================
   SEO FALLBACKS
========================= */
const title = page.title;
const description =
  page.description ||
  "MASK Intelligence official page.";
---

<BaseLayout>

  <article class="page">
    <header class="page-header container">
      <h1>{title}</h1>

      {description && (
        <p class="page-description">
          {description}
        </p>
      )}
    </header>

    <section class="page-body container">
      <AstroMarkdown content={page.body} />
    </section>
  </article>

</BaseLayout>
